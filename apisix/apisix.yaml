routes:
  - uri: /*
    upstream:
      nodes:
        "frontend:3000": 1
      type: roundrobin

  - uri: /products/*
    upstream:
      nodes:
        "product-service:3001": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /products
    upstream:
      nodes:
        "product-service:3001": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /upload
    upstream:
      nodes:
        "product-service:3001": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "POST,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /sales/*
    upstream:
      nodes:
        "sales-service:3002": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /sales
    upstream:
      nodes:
        "sales-service:3002": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /user/*
    upstream:
      nodes:
        "user-service:3003": 1
      type: roundrobin
    plugins:
      proxy-rewrite:
        regex_uri: ["^/user/(.*)", "/$1"]
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /user
    upstream:
      nodes:
        "user-service:3003": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"

  - uri: /auth/*
    upstream:
      nodes:
        "keycloak:8080": 1
      type: roundrobin
    plugins:
      cors:
        allow_origins: "*"
        allow_methods: "GET,POST,PUT,DELETE,OPTIONS"
        allow_headers: "Content-Type,Authorization"
#END
